<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Radicals Escape Room â€” Lesson Review (Student)</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js"></script>
<style>
  body { font-family: system-ui, sans-serif; margin: 0; background: #fff; color: #111; }
  header { padding: 16px; border-bottom: 1px solid #ddd; background: #f9fafb; }
  h1 { margin: 0 0 6px; font-size: 24px; }
  p.sub { margin: 0; color: #555; }
  .rooms { max-width: 960px; margin: 20px auto; display: grid; gap: 20px; }
  .room { border: 1px solid #ddd; border-radius: 12px; overflow: hidden; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,.04); opacity: 1; }
  .room.locked { opacity: .5; pointer-events: none; }
  .room .title { background: #f3f4f6; padding: 12px 16px; border-bottom: 1px solid #ddd; }
  .room .content { padding: 16px; }
  .problem { margin-bottom: 14px; padding: 12px; border: 1px solid #eee; border-radius: 8px; background: #fff; }
  .idx { font-weight: bold; margin-bottom: 6px; }
  .q { margin-bottom: 8px; }
  .input-area { display: flex; gap: 8px; align-items: center; }
  input[type=text] { flex: 1; padding: 8px 10px; border: 1px solid #ccc; border-radius: 8px; }
  button.small { padding: 6px 10px; font-size: 13px; border: 1px solid #ccc; border-radius: 8px; background: #fff; cursor: pointer; }
  .feedback { font-size: 13px; }
  .ok { color: green; }
  .bad { color: red; }
  .room-footer { padding: 10px 16px; border-top: 1px solid #eee; background: #fafafa; font-size: 13px; }
  .unlock { color: green; font-weight: bold; }
  .radical-btn { padding: 6px 8px; font-size: 14px; border: 1px solid #ccc; border-radius: 6px; background: #f3f4f6; cursor: pointer; }
</style>
</head>
<body>
<header>
  <h1>Radicals Escape Room â€” Lesson Review</h1>
  <p class="sub">Simplify each radical expression. Enter answers in simplest radical form with no negative exponents. Click âˆš to insert a radical symbol.</p>
</header>
<main class="rooms" id="rooms"></main>

<script>
function renderKatex(el, tex){ try { katex.render(tex, el, {throwOnError:false}); } catch { el.textContent = tex; } }

const ROOMS = [
  { name:"Room 1 â€” Mild ðŸŒ¶", problems:[
    {q:'-2\\sqrt{6} + 3\\sqrt{6}', ans:['sqrt(6)','1*sqrt(6)']},
    {q:'-4\\sqrt{50} - 5\\sqrt{2}', ans:['-25*sqrt(2)']},
    {q:'-5\\sqrt{12} + 3\\sqrt{3}', ans:['-7*sqrt(3)']},
    {q:'3\\sqrt{72} - 2\\sqrt{98}', ans:['4*sqrt(2)']},
  ]},
  { name:"Room 2 â€” Medium ðŸŒ¶ðŸŒ¶", problems:[
    {q:'-3\\sqrt{8} - \\sqrt{32} - 2\\sqrt{8} - \\sqrt{2}', ans:['-15*sqrt(2)']},
    {q:'-\\sqrt{8} + 3\\sqrt{20} - 2\\sqrt{2} - 3\\sqrt{18}', ans:['6*sqrt(5)-13*sqrt(2)','-13*sqrt(2)+6*sqrt(5)']},
    {q:'-5\\sqrt{2} \\cdot \\sqrt{10}', ans:['-10*sqrt(5)']},
    {q:'\\sqrt{3} \\cdot -3\\sqrt{21}', ans:['-9*sqrt(7)']},
  ]},
  { name:"Room 3 â€” Hot ðŸŒ¶ðŸŒ¶ðŸŒ¶", problems:[
    {q:'2\\sqrt{5} \\cdot \\sqrt{15}', ans:['10*sqrt(3)']},
    {q:'\\sqrt{2p} \\cdot 2\\sqrt{8p^2}', ans:['4p*sqrt(p)','4*p*sqrt(p)','4*sqrt(p)*p']},
    {q:'3\\sqrt{3x} \\cdot 2\\sqrt{12x^2}', ans:['36x*sqrt(x)','36*x*sqrt(x)']},
    {q:'(-2 + \\sqrt{2})(-4 + 3\\sqrt{2})', ans:['14-10*sqrt(2)','-10*sqrt(2)+14']},
  ]},
  { name:"Room 4 â€” Spicy ðŸŒ¶ðŸŒ¶ðŸŒ¶ðŸŒ¶", problems:[
    {q:'(2\\sqrt{6})/(\\sqrt{54})', ans:['2/3']},
    {q:'(4\\sqrt{10})/(\\sqrt{2})', ans:['4*sqrt(5)']},
    {q:'2/\\sqrt{2}', ans:['sqrt(2)']},
    {q:'(3\\sqrt{8})/(2\\sqrt{2})', ans:['3']},
  ]},
];

function buildRooms(){
  const container=document.getElementById('rooms');
  ROOMS.forEach((room,ri)=>{
    const sec=document.createElement('section');
    sec.className='room'+(ri>0?' locked':'');
    sec.dataset.room=ri;
    sec.innerHTML=`<div class="title">${room.name}</div><div class="content"></div><div class="room-footer">Solve all to unlock next room.</div>`;
    const content=sec.querySelector('.content');
    room.problems.forEach((p,pi)=>{
      const prob=document.createElement('div');
      prob.className='problem';
      prob.dataset.i=pi;
      prob.innerHTML=`<div class="idx">${pi+1}.</div><div class="q" data-tex="${p.q}"></div><div class="input-area"><input type=text placeholder="type your simplified answer"><button class=radical-btn>âˆš</button><button class=small>Check</button><span class=feedback></span></div>`;
      content.appendChild(prob);
    });
    container.appendChild(sec);
  });
  document.querySelectorAll('.q').forEach(el=>{renderKatex(el,el.dataset.tex)});
}

function checkUnlock(ri){
  const room=document.querySelector(`.room[data-room="${ri}"]`);
  const solved=room.querySelectorAll('.feedback.ok').length;
  const total=ROOMS[ri].problems.length;
  if(solved===total && ri<ROOMS.length-1){
    const next=document.querySelector(`.room[data-room="${ri+1}"]`);
    next.classList.remove('locked');
    room.querySelector('.room-footer').innerHTML='<span class=unlock>Room cleared! Next unlocked âœ…</span>';
  }
}

function init(){
  buildRooms();
  document.getElementById('rooms').addEventListener('click',e=>{
    if(e.target.tagName==='BUTTON' && e.target.classList.contains('small')){
      const prob=e.target.closest('.problem');
      const ri=+e.target.closest('.room').dataset.room;
      const pi=+prob.dataset.i;
      const input=prob.querySelector('input').value.replace(/\s+/g,'');
      const fb=prob.querySelector('.feedback');
      const acceptable=ROOMS[ri].problems[pi].ans.map(a=>a.replace(/\s+/g,''));
      const ok=acceptable.includes(input);
      if(ok){ fb.textContent='Correct!'; fb.className='feedback ok'; prob.style.borderColor='#86efac'; }
      else { fb.textContent='Try again'; fb.className='feedback bad'; prob.style.borderColor='#fecaca'; }
      checkUnlock(ri);
    }
    if(e.target.tagName==='BUTTON' && e.target.classList.contains('radical-btn')){
      const input=e.target.closest('.problem').querySelector('input');
      const start=input.selectionStart;
      const end=input.selectionEnd;
      input.setRangeText('sqrt()', start, end, 'end');
      input.focus();
    }
  });
  document.getElementById('rooms').addEventListener('keydown',e=>{
    if(e.key==='Enter'){
      const prob=e.target.closest('.problem');
      if(prob){ prob.querySelector('button.small').click(); }
    }
  });
}
document.addEventListener('DOMContentLoaded',init);
</script>
</body>
</html>
